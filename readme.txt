#===========================
#绘制叶绿体边界收缩扩张图
#Lei xul （boy）
#xul@genepioneer.cn
#1275875706@qq.com
#需要在linux下运行、需要perl解释器
#程序在linux下写的，忘了有没有调用linux的命令，所以最好在linux下运行。
#程序仅考虑常规序列
#如有问题想交流，可以联系作者
#个人工作内容：叶绿体、线粒体（动物、植物）、基因组denovo、chip-seq、重测序、及前面所有个性化分析


需要SVG模块，请自行安装：
	cpan SVG

或者源码安装：
	。。。

============================


目录结构
├── bin	
│?? └── irscope_v3.1.pl	#主程序
├── readme.txt	#帮助文档（及广告信息）
├── sample
│?? ├── irscope.v3.1.cfg	#sample的配置文件
│?? ├── NC_007942.1.gbk	#几个测试的样品
│?? ├── NC_009259.1.gbk
│?? ├── NC_013843.gbk
│?? ├── NC_018051.1.gbk
│?? └── NC_022868.1.gbk
└── src
    ├── CPSTAT
    │?? └── CPseq.pm	#一个模块
    ├── get_cfg_file_for_ir3.1.pl	#生成配置文件
    └── yelvti_sc.pl	#调用的代码


===========================
usage:
1.首先使用生成配置文件，可以使用以下脚本生成：
	perl  get_cfg_file_for_ir3.1.pl -i *.gbk 

配置文件的内容为：

NC_007942.1.gbk	83176-108749,126645-152218
NC_009259.1.gbk	79824-106249,123860-150285
NC_013843.gbk	80899-107372,124798-151271

两列，中间用tab键分割
第一列是gbk文件名，注意使用绝对路径。
第二列是反向重复区的位置，格式固定

2.运行主程序
	perl irscope_v3.1.pl -i irscope.v3.1.cfg -o irscope.svg
运行完生成irscope.svg图片，及其转换的图片

===========================
#注意事项，必看！！！！
1.如果想改基因颜色：
	主程序36行开始，有个color，左边是基因名，右边是颜色，也可以自己添加基因或者修改颜色

2.如果反向重复区没有问题（正常时100%相似度），生成的配置文件可以直接使用，如果遇到反向重复区异常的，如下：
	a.反向重复区不是100%相似，如组装的时候没校正好，导致反向重复区有小的碱基差异，需要手动修改反向重复区的位置
	    这个很重要~~~，可以使用mummer，或者blast的找下最大的反向重复区，手动填写重复区。
	    mummer :
		nucmer test.fasta test.fasta && show-coords out.delta > ir.txt
		cat ir.txt  #找最大的反向重复
	
	b.反向重复区太短，里面只有一个基因，这个生成的图片需要修改，建议使用Ai修改pdf格式的，很简单。
	    因为画图的思路就是每个区域的连接处左右各画一个基因，如果重复区太短，或者某区域内只有一个基因，那么这个基因会被画两次

3.正常叶绿体基因组是以LSC开头的，如果起点是从重复区内部开始的，重复区会被分割，这种情况是无法使用get_cfg_file_for_ir3.1.pl获得重复区的位置，
且用mummer或者blast可能都不好确定，需要自行调整序列的起点，不要落在重复区内部。起点不在重复区内的，不影响作图。

4.假基因问题：
	边界处容易出现两个假基因，如ycf1,rps19。有的物种会注释成CDS，有的会注释成pseudo。程序默认不画假基因，如果需要画可以加 -p 选项。但是由于编码问题，
	    假基因的符号打不出来，用的是%表示，可以自行P图。

5.没想到其他问题。。。正常叶绿体执行usage的两步就可以生成图了。

#===========================
如想了解更多问题。欢迎加入qq群：936427018 ~
